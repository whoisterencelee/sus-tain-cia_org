<!doctype html>
<html class="no-js" lang="">

<head>
  <meta charset="utf-8">
  <title>Video Technology Showcase</title>
  <meta name="description" content="Video Technology on Sustaincia">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link rel="manifest" href="/manifest.json">
  <link rel="apple-touch-icon" href="/icon.png">
  <!-- Place favicon.ico in the root directory -->

  <meta name="referrer" content="no-referrer-when-downgrade"><!-- important https://web.dev/referrer-best-practices/ -->
  <meta name="theme-color" content="#fafafa">

</head>

<body style="font-family:Roboto,sans-serif;margin:0;display:flex;flex-direction:column;align-items:center;">
  <!--[if IE]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
	<script>$=(i=>document.getElementById(i)||{})</script>

	<style>
	div {display:flex;flex-direction:column;flex-wrap:wrap;}
	.hide {display:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;}
	.unselectable {-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;}
	</style>

	<!-- header -->
	<style>
	#header {opacity:0.5;}
	#header a {color:white;text-decoration:none;}
	</style>
	<div style="background:#0070c4;color:white;font-size:0.8em;width:100%;flex-direction:row;flex-wrap:nowrap;justify-content:space-around;">
		<div id="header" style="margin:0.35em 1em;display:block;"><a href="/">/</a></div>
		<form id="subscribe" style="width:auto;margin:0;padding:0;" method="POST" action="https://functional.limited/subscribe" name="subscribe">
			<input class="hide" name="subscription" id="subscription"></input>
			<input id="subscribe-submit" type="submit" disabled="disabled" style="opacity:0;color:white;border:0;margin:0.35em 1em;padding:0;cursor:pointer;" value="subscribe"></input>
		</form>
	</div>
	<script>// header code
	var host=document.location.host,path="";document.getElementById('header').innerHTML='<a href="https://'+host+'">'+host+' </a> /'+document.location.pathname.replace(/index.html$/,'').split('/').slice(1).map(p=>{path+="/"+p;return '<a href="https://'+host+path+'"> '+p.replace(/.html$/,'')+' </a>' }).join( "/" )
	</script>
	<script>// subscribe code
if('serviceWorker'in navigator){navigator.serviceWorker.register('/service_worker.js').then(function(){console.log('Successfully registered service worker');function urlBase64ToUint8Array(base64String){var padding='='.repeat((4-base64String.length%4)%4);var base64=(base64String+padding).replace(/\-/g,'+').replace(/_/g,'/').replace(/\n/g,'').replace(/\r/g,'');var rawData=window.atob(base64);var outputArray=new Uint8Array(rawData.length);for(var i=0;i<rawData.length;++i){outputArray[i]=rawData.charCodeAt(i)}return outputArray}function getpush(){navigator.serviceWorker.ready.then(function(reg){return reg.pushManager.getSubscription().then(async function(sub){const response=await fetch('/vapid.txt',{headers:{'Content-Type':'text/plain'}});const vapidPublicKey=await response.text();const convertedVapidKey=urlBase64ToUint8Array(vapidPublicKey);if(sub){if(sub.options&&sub.options.applicationServerKey&&new Uint8Array(sub.options.applicationServerKey).toString()!=convertedVapidKey.toString()){sub.unsubscribe()}else return sub}return reg.pushManager.subscribe({userVisibleOnly:true,applicationServerKey:convertedVapidKey})})}).then(function(sub){$('subscription').value=JSON.stringify(sub);console.log($('subscription').value);$('user').disabled='';$('subscribe').submit()},function(error){alert('push notification setup error : '+error.toString())})}$('subscribe').onsubmit=()=>{console.log('let\'s subscribe');$('user').disabled='disabled';event.preventDefault();if(!('Notification'in window))alert('Notification is required for this page, try a different browser');else if(Notification.permission!=='granted')Notification.requestPermission(p=>{if(p!=='granted')alert('Notification is required for this page, try a different browser');else getpush()});else if(Notification.permission==='granted')getpush()};$('user').disabled='';$('subscribe-submit').disabled='';$('subscribe-submit').style.opacity='0.5'}).catch(function(err){alert('Error whilst registering service worker '+err)})}else alert('Service worker is required for this page, try a different browser');
	</script>


	<!-- pull down tab -->
	<div style="align-items:center;">

		<style>.hpot {display:none;}
		form {display:flex;flex-direction:column;align-items:center;font-family:arial;width:100%;max-width:20em;padding:0.5em 0.5em 0 0.5em;}
		form textarea {background:transparent;border:0;margin:0;border:3px dotted lightgrey;padding:0.5em;font-family:Arial;width:100%;}
		form input {background:transparent;border:0px;padding:0;width:100%;border-bottom:3px dotted lightgrey;padding:0.5em;font-size:1em;}
		form label {display:flex;flex-direction:column;align-items:center;text-align:center;width:100%;}
		form label span {color:grey;}
		form label a {color:#0070c4;text-decoration:none;}
		</style>

		<form id="report" style="display:none;" method="POST" action="https://functional.limited/forms" name="report">

			<div class="hpot"><label>Sustaincia Open Science Platform for Everyone
				<input name="_next" value="https://sustaincia.org/learn/sustaincia_reporting?success">
				<input name="_gotcha">
				<input name="_to" value="https://sustaincia.org/learn/sustaincia_reporting/approve.html">
			</label></div>

			<label>
			<textarea id="editor" tabindex="1" autofocus required cols="30" rows="4" placeholder="ADD REPORT HERE syntax:&#x0a;*bold text*&#x0a;[[https://../image url]]&#x0a;[[https://..][link]]" required name="content"></textarea>
			</label>

			<label>
			<input required placeholder="post as reporter" tabindex="2" name="user"></input>
			</label>

			<label>
			<input placeholder="offering" tabindex="3" name="offer"></input>
			</label>

			<div tabindex="-1" style="outline:0;height:0.5em;width:100%;"></div><!-- focusable spacing -->

			<input tabindex="4" style="background:#4eadb8;color:white;border:0;box-shadow:3px 3px 5px 0px lightgrey;cursor:pointer;" type="submit" value="submit"></input>

		</form>

		<!-- down arrow -->
		<div class="unselectable" tabindex="-1" style="outline:0;border-top:1em solid #4eadb8;border-left:1em solid transparent;border-right:1em solid transparent;height:0;width:0;" 
			onclick="var c=event.currentTarget.parentNode.childNodes,cl=c.length;while(cl--){if(c[cl].style&&c[cl].style.display)c[cl].style.display=''}">
			<div style="position:relative;bottom:1.35em;left:-0.25em;color:white;font-weight:bold;opacity:0.5;">+</div>
		</div>
	
		<div id="preview" style="display:none;">
			<div id="render" class="list" style="margin:0 25vw;min-width:340px;"></div>
		</div>
		
	</div>

		<script>function org2html(orgmode){return"<div>"+orgmode.replace(/\[\[[^\]]+\]\]/g,img=>img.replace("[[",'<img src="').replace("]]",'" />')).replace(/\[\[.+\]\[.+\]\]/g,a=>a.replace("[[",'<a href="').replace("][",'">').replace("]]","</a>")).replace(/\*[^\*]+\*/g,b=>b.replace("*","<b>").replace("*","</b>")).replace(/\n/g,"<br />")+"</div>"}let render=()=>{$("render").innerHTML=org2html($("editor").value)};$("editor").onkeyup=render;render();</script>

	<!-- messagebuttons -->
	<style>
	.messagebutton {text-decoration:none;text-align:center;background:#4eadb8;color:#032a2e;padding:1em;box-shadow:3px 3px 5px 0px lightgrey;margin:1em;}
	</style>
	<a id="success" class="hide messagebutton" href="https://sustaincia.org/make/sustaincia_identity" rel="noreferrer noopener" target="_blank">
	Thank you for your submission we will review and post it asap<br />In the meantime click thur to our "community identity living document"
	</a>
	<div id="approve" class="hide messagebutton">
	Thank you for your approval, the decision has <span id="triggered" class="hide"> NOT YET</span> triggered
	</div>
	<div id="subscribed" class="hide messagebutton">
	Subscribed
	</div>


	<script>
	var u = new URLSearchParams( location.search )
	if(u.get('success')!=null)$('success').style.display="block"
	if(u.get('approve')!=null)$('approve').style.display="block"
	if(u.get('triggered')==null)$('triggered').style.display="inline"
	if(u.get('subscribed')!=null)$('subscribed').style.display="block"
	</script>

	<!-- funding -->
	<div>
		<span id=support_en>Supporters <u>fund</u> our work and help maintain this page for </span>
		<span id=until until="2022/07/17 00:00 +8">03:00:00:00</span>
		<span id=support_zh>支持者<u>資助</u>我們的工作並維持此頁的剩下時間</span><br />
		<small>
		Terence Lee / 
		Leo Lau / 
		Bashir Saidu / 
		Winston Lam / 
		Anonymous
		</small>
		<div id=donate_en style="display:none;position:fixed;background:darkred;">Payment Methods</div>
		<div id=donate_zh style="display:none;position:fixed;background:darkred;">付款方式</div>
	</div>
	<script>
		setInterval( ()=>{
			var until = $( 'until' ).getAttribute( 'until' )
			
			var timeleft = ( new Date( until ).getTime() - new Date().getTime() ) / 1000 / 60 / 60 / 24
			if( timeleft < 0 ) timeleft = 3
			var daysleft = Math.floor( timeleft , 1 )
			timeleft = ( timeleft - daysleft ) * 24
			var hoursleft = Math.floor( timeleft , 1 )
			timeleft = ( timeleft - hoursleft ) * 60
			var minsleft = Math.floor( timeleft , 1 )
			timeleft = ( timeleft - minsleft ) * 60
			var secsleft = Math.floor( timeleft , 1 )
			timeleft -= secsleft

			$( 'until' ).textContext = daysleft + ':' + hoursleft + ':' + minsleft + ':' + secsleft
		} , 5000 )
		$( 'support_en' ).addEventListener( 'click' , () => $( 'donate_en' ).style.display='block' )
		$( 'support_zh' ).addEventListener( 'click' , () => $( 'donate_zh' ).style.display='block' )
	</script>
	<!-- TODO 
		cut mechanism
		link sharing with #t
		poster from query
	-->

	<style>
	.list > div {display:inline-block;padding-bottom:0.5em;margin:0.25em 0;border-bottom:1px solid lightgrey;color:grey;}
	.list > div > img {margin:0 1em 0 0;float:left;max-height:30vh;max-width:90vw;}
	.list > div > video {margin:0 1em 0 0;float:left;max-height:30vh;max-width:60vw;}
	.list > div > iframe {margin:0 1em 0 0;max-height:36vw;max-width:64vw;}
	.list > div > b {color:black;}
	.list > div > a {color:grey;}
	.list > div > table {text-align:center;border-spacing:2em 0;font-size:0.75em;word-break;break-all;max-width:90vw;}
	</style>

	<div style="margin:0 25vw;min-width:340px;">
	<div class="list" onclick="copyanchor()" >
	<!-- list -->

	</div><!-- end of list -->
	</div><!-- padding -->

	<!-- vidinstructor -->
	<div style="width:98vw;height:100vh;display:flex;flex-direction:column;align-items:center;"> <!-- not sure about overflow:clip; -->
		<style>
		.videoside {width:100%;max-height:50%;}
		video#vidstructor {width:100%;height:100%;}
		#videoscript {width:100%;}
		@media (min-aspect-ratio: 3/2) {
			.videoside {max-width:66%;max-height:100%;}
			#videoscript {width:33%;}
			video#vidstructor {width:100%;height:100%;}
		}
		/*video#vidstructor {max-width:100%;max-height:50%;background:black;}
		@media (min-aspect-ratio: 3/2) {
			video#vidstructor {max-width:66%;max-height:100%;}
			#videoscript {width:33vw;}
		}
		*/
		#videoscript {flex-grow:1;flex-wrap:nowrap;overflow:scroll;}
		#videoscript {height:50%;} /* important need to set otherwise when scroll video moves out*/
		.videosection {padding:1em;flex-direction:row;justify-content:space-between;border-bottom:1px black solid;text-overflow:ellipsis;}
		</style>
		<div class=videoside>
			<video id=vidstructor controls preload=auto 
				poster='http://localhost:8080/ipfs/QmX84qEMPYg17DehYHXb5TmzNnNBS5LtgEEpMbtQoRgX86'
			>
			<!--poster='https://www.googleapis.com/drive/v3/files/1uhaYcP7dh9nomQIR3qUOAlxIL3c0FGba?alt=media&key=AIzaSyCCF2GrqNbgdpEfDnJifTa0JQ6zbmBN9FE'-->
				<source 
					type="video/mp4"
					src="http://localhost:8080/ipfs/QmNgndFuYj8CXLmMsyUXE6co1arTpa6pHSQQwLaqPPq3NM"
					type="video/mp4"
					data-original="https://onedrive.live.com/download?cid=3FE21E3ED1DB2476&resid=3FE21E3ED1DB2476%21111745&authkey=AKv1dWd58c81qkc"
					>
				<!--src="https://www.googleapis.com/drive/v3/files/10SiVfo1vQDjKLS46pQFhbuQqGq-dpQX1?alt=media&key=AIzaSyCCF2GrqNbgdpEfDnJifTa0JQ6zbmBN9FE"-->
			</video>
		</div>
		<div id=videoscript> 
		</div>
		<script>
		segments_raw = {"peaks.segment.2":{"startTime":0,"endTime":13.653333333333334,"id":"peaks.segment.2","labelText":"cut"},"peaks.segment.4":{"startTime":34.179773,"endTime":81.08408163265307,"id":"peaks.segment.4","labelText":"cut"},"peaks.segment.5":{"startTime":81.08408163265307,"endTime":140.62004535147392,"id":"peaks.segment.5","labelText":"jiangyisheng"},"peaks.segment.6":{"startTime":142.38476190476192,"endTime":302.6953287981859,"id":"peaks.segment.6","labelText":"macao sar"},"peaks.segment.7":{"startTime":302.788209,"endTime":518.7337868480726,"id":"peaks.segment.7","labelText":"hengqin"},"peaks.segment.8":{"startTime":518.919546,"endTime":716.1962811791383,"id":"peaks.segment.8","labelText":"dubai"},"peaks.segment.9":{"startTime":725.205624,"endTime":2025.2444444444445,"id":"peaks.segment.9","labelText":"xiaoping"},"peaks.segment.10":{"startTime":2026.544762,"endTime":3008.1915646258503,"id":"peaks.segment.10","labelText":"niujianjun"},"peaks.segment.12":{"startTime":2038.897778,"endTime":2049.2074376417236,"id":"peaks.segment.12","labelText":"cut"},"peaks.segment.13":{"startTime":3009.491882,"endTime":3025.095691609977,"id":"peaks.segment.13","labelText":"cut"},"peaks.segment.16":{"startTime":3037.170068,"endTime":3218.935873015873,"id":"peaks.segment.16","labelText":"liujiying"},"peaks.segment.17":{"startTime":3219.214512,"endTime":4647.241723356009,"id":"peaks.segment.17","labelText":"michellechan"},"peaks.segment.18":{"startTime":4648.7278,"endTime":4663.588571428571,"id":"peaks.segment.18","labelText":"carlosfan"},"peaks.segment.19":{"startTime":4663.722086,"endTime":4681.444716553288,"id":"peaks.segment.19","labelText":"cut"},"peaks.segment.20":{"startTime":4681.537596,"endTime":5516.225306122449,"id":"peaks.segment.20","labelText":"carlosfan"},"peaks.segment.21":{"startTime":5516.225306,"endTime":5792.542766439909,"id":"peaks.segment.21","labelText":"terencelee"},"peaks.segment.22":{"startTime":5792.547122,"endTime":5940.964716553288,"id":"peaks.segment.22","labelText":"leoliu"},"peaks.segment.23":{"startTime":5941.150476,"endTime":6533.445079365079,"id":"peaks.segment.23","labelText":"bashirsaidu"},"peaks.segment.24":{"startTime":6538.01941,"endTime":6566.603174603175,"id":"peaks.segment.24","labelText":"terencelee"},"peaks.segment.26":{"startTime":6572.816363,"endTime":6682.424308390023,"id":"peaks.segment.26","labelText":"bashirsaidu"},"peaks.segment.27":{"startTime":6695.613243,"endTime":6811.062857142857,"id":"peaks.segment.27","labelText":"alessandrolampo"},"peaks.segment.28":{"startTime":6819.050522,"endTime":7252.149115646259,"id":"peaks.segment.28","labelText":"alexlobo"},"peaks.segment.29":{"startTime":7253.077914,"endTime":7268.681723356009,"id":"peaks.segment.29","labelText":"cut"},"peaks.segment.30":{"startTime":7268.867483,"endTime":7394.533877551021,"id":"peaks.segment.30","labelText":"brunoknudsen"},"peaks.segment.31":{"startTime":7415.617596,"endTime":8440.639274376417,"id":"peaks.segment.31","labelText":"rickylee"},"peaks.segment.32":{"startTime":8442.31111111111,"endTime":9765.941405895692,"id":"peaks.segment.32","labelText":"qanda"},"peaks.segment.35":{"startTime":8508.81306122449,"endTime":9062.283900226757,"id":"peaks.segment.35","labelText":"xiaoping"},"peaks.segment.36":{"startTime":9064.513016,"endTime":9301.449433106576,"id":"peaks.segment.36","labelText":"pachira"},"peaks.segment.37":{"startTime":9301.519092970522,"endTime":9499.88716553288,"id":"peaks.segment.37","labelText":"michellechan"},"peaks.segment.38":{"startTime":9543.54068,"endTime":9613.246984126985,"id":"peaks.segment.38","labelText":"xiaoping"},"peaks.segment.39":{"startTime":9620.35229,"endTime":9671.575510204082,"id":"peaks.segment.39","labelText":"terencelee"},"peaks.segment.40":{"startTime":9672.968707,"endTime":9750.662675736961,"id":"peaks.segment.40","labelText":"xiaoping"},"peaks.segment.41":{"startTime":9788.371882086169,"endTime":9789.068480725624,"id":"peaks.segment.41","labelText":"leoliu"},"peaks.segment.42":{"startTime":9789.164791,"endTime":9823.759092970522,"id":"peaks.segment.42","labelText":"cut"}}
		segments = Object.entries( segments_raw )
		</script>
		<script>
		video = document.querySelector('video#vidstructor');
		nav = $( 'videoscript' )
		for( var s in segments ){
			var seg = segments[ s ][ 1 ]
			if( seg.labelText == "cut" ) continue
			var se_dom = document.createElement( "div" )
			se_dom.setAttribute( "class" , "videosection" )
			se_dom.setAttribute( 't-start' , seg.startTime )
			se_dom.setAttribute( 't-end' , seg.endTime )
			se_dom.innerHTML = '<p>'+ seg.labelText + '</p>'
			nav.appendChild( se_dom )
		}
		buttons = nav.getElementsByClassName('videosection');
		for (var i = buttons.length - 1; i >= 0; i--) {
			buttons[i].addEventListener('click', function(){
				var from = this.getAttribute( 't-start' ).split(':').reverse().reduce( ( pv , cv , n ) => pv + parseInt( cv ) * Math.pow( 60 , n ) , 0 )
				var to = this.getAttribute( 't-end' ).split(':').reverse().reduce( ( pv , cv , n ) => pv + parseInt( cv ) * Math.pow( 60 , n ) , 0 )
				video.playFragment( from , to )
				this.style.background = "lightgreen"
			} )
		}

		/** ref: https://front.id/en/articles/play-html-5-video-tag-fragment-videoplayfragment
		 * Plays a video fragment.
		 *
		 * @param {Number} from The time video where to start. 
		 * If this param is null the video will be played from the current position.
		 * @param {Number} to The time video where to stop.
		 * @param {Number} frameRate The video framerate.
		 * @param {Function} cb Callback launched after fragment is played. Optional.
		 */
		playing = false  // used if you want to lock until finish playing
		timeCheck = null
		HTMLVideoElement.prototype.playFragment = function (from, to, frameRate = 1000, cb) {
		  if (playing) return;
		  // const video = this;
		  video.currentTime = from === null ? video.currentTime : from;
		  video.play();

		  if( timeCheck ) clearInterval( timeCheck )  // a new Fragment started
		  timeCheck = setInterval(function () {
		    if (video.currentTime >= to) {
		      clearInterval(timeCheck);
		      video.pause();
		      playing = false;
		      typeof cb === 'function' && cb();
		    }
		  }, 1000 / frameRate);
		};

		// not working, click event on video doesn't work on firefox
		video.addEventListener('mouseover',function() { 
						video.muted = false; });
		</script>
	</div>

	<!--
	<a href="https://towardsdatascience.com/how-to-use-vest-a-free-online-tool-for-segmenting-video-clips-a6ec50e29971">For video segmentation check out this tool</a>
	-->

	<!-- copyanchor -->
	<textarea id="copyanchor" style="position:absolute;top:-8888px;" readonly></textarea>
	<div id="anchorcopied" class="hide" style="background:#0070c4;color:white;padding:0.5em 1em;border-radius:3em;position:fixed;bottom:3em;font-size:0.75em;">anchor copied , paste into any chat</div>
	<script>
	function copyanchor(){
		var p = event.target
		if( p.nodeName == "A" ) return  // don't copy if user leaving
		while( p.parentNode.className != "list" ){ p = p.parentNode ; if( p == document ) return }
		var text = p.textContent.substring( 0 , 64 ).replace( /\s[^\s]*$/ , "" )  // cut off between words
		$("copyanchor").value = text + "..\n" + document.location.origin + document.location.pathname.replace( /index.html$/ , "" ) + "#" + p.id
		$("copyanchor").select()
		document.execCommand( "copy" )
		$("anchorcopied").style.display="block"
		setTimeout( ()=>$("anchorcopied").style.display="" , 3000 )
	}
	</script>
	<!-- copyanchor -->

	<!-- analytics -->
	<script>
	fetch( 'https://functional.limited/log' , { method: "POST" , body : 'href=' + location.href} )
	</script>
	<!-- analytics -->

</body>

</html>
